{% extends "admin/base.html" %}

{% block content %}
<div class="main-text" style="padding: 20px;">

  {% if current_user.is_authenticated and current_user.role == 'admin' %}
    <div class="admin-welcome-message">
      Welcome Admin {{ current_user.username }}
    </div>
  {% endif %}

  <h1 class="title">
    {% if session['lang'] == "sw" %}
      Mfumo una jumla ya watumiaji <span class="user-count">{{ user_count }}</span><br />
      Orodha ya watumiaji wa mfumo huu
    {% else %}
      The system has a total of <span class="user-count">{{ user_count }}</span> users<br />
      List of users of this system
    {% endif %}
  </h1>
  
  <div class="table-responsive mt-3">
    <table class="table text-dark">
      <thead>
        <tr>
          <th scope="col">
            {% if session['lang'] == "sw" %}
              Jina la mtumiaji
            {% else %}
              Username
            {% endif %}
          </th>
          <th scope="col">
            {% if session['lang'] == "sw" %}
              Umri
            {% else %}
              Age
            {% endif %}
          </th>
          <th scope="col">
            {% if session['lang'] == "sw" %}
              Jinsia
            {% else %}
              Gender
            {% endif %}
          </th>
          <th scope="col">Role</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
          <tr class="">
            <td>{{ user.username }}</td>
            <td>{{ user.age }}</td>
            <td>{{ user.gender }}</td>
            <td>{{ user.role }}</td>
            <td>
              {% if user.role != 'admin' %}
                <form method="POST" action="{{ url_for('delete_account', user_id=user.id) }}" class="delete-account">
                  <button type="submit" onclick="return confirm('Are you sure you want to delete this user?');">Delete Account</button>
                </form>
              {% else %}
                <p>Admin account.</p>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock content %}

{% set curr_page = "users" %}
