{% extends 'base.html' %}

{% block content %}
<div class="subtitle text-center">
    {% if session['lang'] == "sw" %}
        Jisajili
    {% else %}
        Registration
    {% endif %}
</div>
<div class="mb-3" style="background-color: #f0f0f0; padding: 10px; border-radius: 5px; box-shadow: 0 0 5px rgba(0, 0, 0, 0.2);">
    <small style="font-weight: bold; color: #333;">
        {% if session['lang'] == "sw" %}
            <strong>Usiogope:</strong>
            Hatukusanyi taarifa binafsi. 
            Tafadhali tumia jina lisilo kutambulisha ila la kipekee na nenosiri imara
        {% else %}
            <strong>Disclaimer:</strong>
            We do not collect any personal information. Use a non-identifying but 
            unique username and a strong password.
        {% endif %}
    </small>
</div>

<div>
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <div class="alert alert-danger">
                <ul>
                    {% for message in messages %}
                        <li>{{ message }}</li>
                    {% endfor %}
                </ul>
            </div>
        {% endif %}
    {% endwith %}
    
    <div class="login-box">
        <form method="post" action="{{ url_for('register') }}">
            <div class="mb-3">
                <label for="username" class="form-label subtext">
                    {% if session['lang'] == "sw" %}
                        Jina la mtumiaji<span class="required-field">*</span>
                    {% else %}
                        Username<span class="required-field">*</span>
                    {% endif %}
                </label>
                <input type="text" name="username" id="username" class="custom-form-control" placeholder="{% if session['lang'] == 'sw' %}Jina la mtumiaji{% else %}Username{% endif %}" required>
            </div>
            <div class="mb-3">
                <label for="age" class="form-label subtext">
                    {% if session['lang'] == "sw" %}
                        Ingiza umri wako<span class="required-field">*</span>
                    {% else %}
                        Enter your age<span class="required-field">*</span>
                    {% endif %}
                </label>
                <input type="number" class="custom-form-control" name="age" id="age" inputmode="numeric" placeholder="" required>
                <div id="age-error" class="text-danger" style="display: none;">
                    {% if session['lang'] == "sw" %}
                        Umri haupaswi kuwa chini ya 13 au zaidi ya 99.
                    {% else %}
                        Age should not be less than 13 or more than 99.
                    {% endif %}
                </div>
            </div>
            <div class="mb-3">
                <label for="gender" class="form-label subtext">
                    {% if session['lang'] == "sw" %}
                        Chagua jinsia yako<span class="required-field">*</span>
                    {% else %}
                        Select your gender<span class="required-field">*</span>
                    {% endif %}
                </label>
                <select name="gender" id="gender" class="custom-form-select gender-select" required>
                    <option value="">
                        {% if session['lang'] == "sw" %}
                            -- Chagua jinsia yako --
                        {% else %}
                            -- Select your gender --
                        {% endif %}
                    </option>
                    <option value="Female">
                        {% if session['lang'] == "sw" %}
                            Mwanamke
                        {% else %}
                            Female
                        {% endif %}
                    </option>
                    <option value="Male">
                        {% if session['lang'] == "sw" %}
                            Mwanaume
                        {% else %}
                            Male
                        {% endif %}
                    </option>
                </select>
            </div>
            
          <!-- Password field with toggle icon -->
<div class="mb-3">
    <label for="password" class="form-label subtext">
        {% if session['lang'] == "sw" %}Nenosiri{% else %}Password{% endif %}
    </label>
    <div class="password-wrapper">
        <input type="password" name="password" id="password" class="custom-form-control" placeholder="{% if session['lang'] == 'sw' %}nenosiri{% else %}Password{% endif %}" minlength="6" maxlength="128" required>
        <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('password')"></i>
    </div>
    <div id="password-length-error" class="text-danger" style="display: none;">
        {% if session['lang'] == "sw" %}
            Nenosiri linapaswa kuwa angalau herufi 6.
        {% else %}
            Password should be at least 6 characters.
        {% endif %}
    </div>
    <div id="password-number-error" class="text-danger" style="display: none;">
        {% if session['lang'] == "sw" %}
            Nenosiri linapaswa kuwa na angalau nambari moja.
        {% else %}
            Password should contain at least one number.
        {% endif %}
    </div>
    <div id="password-uppercase-error" class="text-danger" style="display: none;">
        {% if session['lang'] == "sw" %}
            Nenosiri linapaswa kuwa na angalau herufi kubwa moja.
        {% else %}
            Password should contain at least one uppercase letter.
        {% endif %}
    </div>
    <div id="password-lowercase-error" class="text-danger" style="display: none;">
        {% if session['lang'] == "sw" %}
            Nenosiri linapaswa kuwa na angalau herufi ndogo moja.
        {% else %}
            Password should contain at least one lowercase letter.
        {% endif %}
    </div>
</div>

<!-- Confirm Password field with toggle icon -->
<div class="mb-3">
    <label for="confirm_password" class="form-label subtext">
        {% if session['lang'] == "sw" %}Thibitisha Nenosiri{% else %}Confirm Password{% endif %}
    </label>
    <div class="password-wrapper">
        <input type="password" name="confirm_password" id="confirm_password" class="custom-form-control" placeholder="{% if session['lang'] == 'sw' %}thibitisha nenosiri{% else %}Confirm Password{% endif %}" minlength="6" maxlength="128" required>
        <i class="fas fa-eye toggle-password" onclick="togglePasswordVisibility('confirm_password')"></i>
    </div>
    <div id="password-confirm-error" class="text-danger" style="display: none;">
        {% if session['lang'] == "sw" %}
            Nenosiri hazilingani.
        {% else %}
            Passwords do not match.
        {% endif %}
    </div>
</div>

<style>
    .toggle-password {
        color: #007bff; /* Set the color to #007bff (blue) */
        cursor: pointer;
    }
</style>

            <div class="mb-3">
                {% if session["lang"] == "sw" %}
                    Jibu maswali yafuatayo. Maswali haya yatatumika kurejesha nenosiri lako
                    iwapo utalipoteza.
                {% else %}
                    Answer the following questions. These questions will be used to recover your password
                    in case you lose it.
                {% endif %}
            </div>
            {% for qn in qns %}
                <div class="mb-3">
                    <label for="qn{{qn.id}}" class="form-label subtext">
                        {% if session["lang"] == "sw" %}
                            {{qn.text_sw}}
                        {% else %}
                            {{qn.text}}
                        {% endif %}
                    </label>
                    <input type="text" name="qn-{{qn.id}}" id="qn{{qn.id}}" class="custom-form-control" placeholder="answer" required>
                </div>
            {% endfor %}
            <div class="mb-3 text-center">
                <input 
                    type="submit" 
                    value="{% if session['lang'] == 'sw' %}Jisajili{% else %}Register{% endif %}" 
                    class="custom-btn px-4 text">
            </div>
        </form>
    </div>
</div>
{% endblock %}
